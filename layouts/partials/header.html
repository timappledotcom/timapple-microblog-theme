<header class="site-header">
  <div class="container">
    
    {{/* Site Masthead */}}
    <div class="site-masthead" style="text-align: center;">
      <h1 class="site-title">
        <a href="{{ .Site.BaseURL }}">{{ .Site.Title }}</a>
      </h1>
      <p class="date-banner" style="text-align: center;">{{ now.Format "Monday, January 2, 2006" }}</p>
    </div>

    {{/* Main Navigation - Uses Micro.blog's page management */}}
    <nav class="site-nav" role="navigation" aria-label="Main navigation">
      <ul>
        <li><a href="{{ .Site.BaseURL }}" {{ if .IsHome }}class="active"{{ end }}>Home</a></li>
        {{/* Dynamic pages from Micro.blog settings - sorted by Weight */}}
        {{ range sort .Site.Menus.main "Weight" }}
          <li>
            {{/* Check if current page matches menu URL or if we're on a category page matching this menu item */}}
            {{ $menuURL := .URL | relLangURL }}
            {{ $isActive := eq $.RelPermalink $menuURL }}
            {{/* Also check if current page title matches menu name (for categories like Essays/Notes) */}}
            {{ if not $isActive }}
              {{ $isActive = eq $.Title .Name }}
            {{ end }}
            {{/* Also check if URL contains the menu name (case-insensitive match for category pages) */}}
            {{ if not $isActive }}
              {{ $lowerName := .Name | lower }}
              {{ $isActive = in $.RelPermalink $lowerName }}
            {{ end }}
            {{ if .Page.Params.redirect }}
              <a href="{{ .Page.Params.redirect }}">{{ .Name }}</a>
            {{ else }}
              <a href="{{ .URL | relLangURL | safeURL }}"{{ if $isActive }} class="active"{{ end }}>{{ .Name }}</a>
            {{ end }}
          </li>
        {{ end }}
      </ul>
    </nav>

  </div>
</header>
